import{_ as e,z as a,a3 as s,U as n,a4 as o,W as t,B as c,E as l,a5 as i,o as u,c as r,w as d,a6 as p,e as f,f as m,i as k,O as g,I as h,q as _}from"./index-6786ed43.js";import{g as x}from"./graceCheck.405c0f54.js";const b=e({data:()=>({cannotBack:!0}),methods:{formSubmit:function(e){var c=e.detail.value;x.check(c,[{name:"phone",checkType:"notnull",checkRule:"",errorMsg:"请填写账号"},{name:"password",checkType:"notnull",checkRule:"",errorMsg:"请填写密码"}])?s("/user/login",c).then((e=>{let{code:s,data:c,flag:l,message:i}=e;4022!=s||l?2e3===s&&l&&(n("accessToken",c.accessToken),o({key:"mytoken",data:{accessToken:c.accessToken},success(){console.log("存储成功")}}),a({title:"登录成功",icon:"none"}),t({url:"/pages/index/index"})):a({title:c,icon:"none"})})).catch((e=>{console.log("error==",e)})):a({title:x.error,icon:"none"})},goSingup:function(e){c({url:"/pages/singup/index"})}},onBackPress(e){return this.cannotBack&&t({url:"/pages/index/index"}),!!this.cannotBack},onShow(){l("accessToken")&&(that.cannotBack=!1,i())}},[["render",function(e,a,s,n,o,t){const c=k,l=g,i=h,x=_,b=p;return u(),r(b,{onSubmit:t.formSubmit},{default:d((()=>[f(c,{class:"uni-form-item"},{default:d((()=>[f(c,{class:"title"},{default:d((()=>[m("登录账号")])),_:1}),f(l,{class:"uni-input",name:"phone",placeholder:"账号登录"})])),_:1}),f(c,{class:"uni-form-item"},{default:d((()=>[f(c,{class:"title"},{default:d((()=>[m("登录密码")])),_:1}),f(l,{class:"uni-input",name:"password",password:"",placeholder:"请输入密码"})])),_:1}),f(c,{class:"uni-btn-v"},{default:d((()=>[f(i,{type:"warn",plain:"true","form-type":"submit"},{default:d((()=>[m("登录")])),_:1})])),_:1}),f(c,{class:"sing-up-box"},{default:d((()=>[f(x,{onClick:t.goSingup},{default:d((()=>[m("马上注册")])),_:1},8,["onClick"]),f(x,null,{default:d((()=>[m("忘记密码？")])),_:1})])),_:1})])),_:1},8,["onSubmit"])}],["__scopeId","data-v-6a7f48ac"]]);export{b as default};
