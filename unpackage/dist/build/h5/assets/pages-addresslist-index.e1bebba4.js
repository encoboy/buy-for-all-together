import{_ as t,o as e,c as s,w as o,e as n,j as i,b as a,F as r,d as l,n as d,l as h,f as c,t as u,q as f,i as p,E as g,z as m,af as w,B as b,ag as v,W as y,r as C,I as S}from"./index-6786ed43.js";import{r as x}from"./uni-app.es.97479408.js";let k={},_=null;_=function(){var t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],s=!0;for(let o=0;o<e.length-1;o++)if(t.indexOf(e[o])>0){s=!1;break}return s}(),k={data:()=>({is_show:"none"}),watch:{show(t){this.is_show=this.show}},created(){this.swipeaction=this.getSwipeAction(),void 0!==this.swipeaction.children&&this.swipeaction.children.push(this)},mounted(){this.is_show=this.show},methods:{closeSwipe(t){this.autoClose&&this.swipeaction.closeOther(this)},change(t){this.$emit("change",t.open),this.is_show!==t.open&&(this.is_show=t.open)},appTouchStart(t){if(_)return;const{clientX:e}=t.changedTouches[0];this.clientX=e,this.timestamp=(new Date).getTime()},appTouchEnd(t,e,s,o){if(_)return;const{clientX:n}=t.changedTouches[0];let i=Math.abs(this.clientX-n),a=(new Date).getTime()-this.timestamp;i<40&&a<300&&this.$emit("click",{content:s,index:e,position:o})},onClickForPC(t,e,s){_&&this.$emit("click",{content:e,index:t,position:s})}}};var T=!1;function X(t,e){var s=t.instance,o=s.getDataset().disabled,n=s.getState();W(s,e),(o=("string"==typeof o?JSON.parse(o):o)||!1)||(s.requestAnimationFrame((function(){s.removeClass("ani"),e.callMethod("closeSwipe")})),n.x=n.left||0,function(t){var e=t.instance,s=e.getState();Y(e);var o=t.touches[0];T&&I()&&(o=t);s.startX=o.clientX,s.startY=o.clientY}(t))}function D(t,e){var s=t.instance,o=s.getDataset().disabled,n=s.getState();(o=("string"==typeof o?JSON.parse(o):o)||!1)||(!function(t){var e=t.instance.getState(),s=t.touches[0];T&&I()&&(s=t);e.deltaX=s.clientX-e.startX,e.deltaY=s.clientY-e.startY,e.offsetY=Math.abs(e.deltaY),e.offsetX=Math.abs(e.deltaX),e.direction=e.direction||function(t,e){if(t>e&&t>10)return"horizontal";if(e>t&&e>10)return"vertical";return""}(e.offsetX,e.offsetY)}(t),"horizontal"===n.direction&&(t.preventDefault&&t.preventDefault(),$(n.x+n.deltaX,s)))}function A(t,e){var s=t.instance,o=s.getDataset().disabled,n=s.getState();(o=("string"==typeof o?JSON.parse(o):o)||!1)||function(t,e,s){var o=e.getState(),n=o.threshold;o.position;var i=o.isopen||"none",a=o.leftWidth,r=o.rightWidth;if(0===o.deltaX)return void F("none",e,s);F("none"===i&&r>0&&-t>n||"none"!==i&&r>0&&r+t<n?"right":"none"===i&&a>0&&t>n||"none"!==i&&a>0&&a-t<n?"left":"none",e,s)}(n.left,s,e)}function $(t,e,s){t=t||0;var o,n,i,a=e.getState(),r=a.leftWidth,l=a.rightWidth;a.left=(o=t,n=-l,i=r,Math.min(Math.max(o,n),i)),e.requestAnimationFrame((function(){e.setStyle({transform:"translateX("+a.left+"px)","-webkit-transform":"translateX("+a.left+"px)"})}))}function W(t,e){var s,o,n=t.getState(),i=e.selectComponent(".button-group--left"),a=e.selectComponent(".button-group--right");s=i.getBoundingClientRect(),o=a.getBoundingClientRect(),n.leftWidth=s.width||0,n.rightWidth=o.width||0,n.threshold=t.getDataset().threshold}function F(t,e,s){var o=e.getState(),n=o.leftWidth,i=o.rightWidth,a="";switch(o.isopen=o.isopen?o.isopen:"none",t){case"left":a=n;break;case"right":a=-i;break;default:a=0}o.isopen!==t&&(o.throttle=!0,s.callMethod("change",{open:t})),o.isopen=t,e.requestAnimationFrame((function(){e.addClass("ani"),$(a,e)}))}function Y(t){var e=t.getState();e.direction="",e.deltaX=0,e.deltaY=0,e.offsetX=0,e.offsetY=0}function I(){for(var t=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],s=!0,o=0;o<e.length-1;o++)if(t.indexOf(e[o])>0){s=!1;break}return s}"object"==typeof window&&(T=!0);var M=!1;const z={showWatch:function(t,e,s,o){var n=o.getState();W(o,s),t&&"none"!==t?F(t,o,s):(n.left&&F("none",o,s),Y(o))},touchstart:X,touchmove:D,touchend:A,mousedown:function(t,e){T&&I()&&(X(t,e),M=!0)},mousemove:function(t,e){T&&I()&&M&&D(t)},mouseup:function(t,e){T&&I()&&(A(t,e),M=!1)},mouseleave:function(t,e){T&&I()&&(M=!1)}},O=t=>{t.$wxs||(t.$wxs=[]),t.$wxs.push("wxsswipe"),t.mixins||(t.mixins=[]),t.mixins.push({beforeCreate(){this.wxsswipe=z}})},P={showWatch(t,e,s,o,n){var i=n.state;(s.$el||s.$vm&&s.$vm.$el)&&(this.getDom(o,s,n),t&&"none"!==t?this.openState(t,o,s,n):(i.left&&this.openState("none",o,s,n),this.resetTouchStatus(o,n)))},touchstart(t,e,s){let o=t.instance,n=o.getDataset().disabled,i=s.state;this.getDom(o,e,s),n=this.getDisabledType(n),n||(o.requestAnimationFrame((function(){o.removeClass("ani"),e.callMethod("closeSwipe")})),i.x=i.left||0,this.stopTouchStart(t,e,s))},touchmove(t,e,s){let o=t.instance;if(!o)return;let n=o.getDataset().disabled,i=s.state;if(n=this.getDisabledType(n),n)return;if(this.stopTouchMove(t,s),"horizontal"!==i.direction)return;t.preventDefault&&t.preventDefault();let a=i.x+i.deltaX;this.move(a,o,e,s)},touchend(t,e,s){let o=t.instance,n=o.getDataset().disabled,i=s.state;n=this.getDisabledType(n),n||this.moveDirection(i.left,o,e,s)},move(t,e,s,o){t=t||0;let n=o.state,i=n.leftWidth,a=n.rightWidth;n.left=this.range(t,-a,i),e.requestAnimationFrame((function(){e.setStyle({transform:"translateX("+n.left+"px)","-webkit-transform":"translateX("+n.left+"px)"})}))},getDom(t,e,s){var o=s.state,n=e.$el||e.$vm&&e.$vm.$el,i=n.querySelector(".button-group--left"),a=n.querySelector(".button-group--right");o.leftWidth=i.offsetWidth||0,o.rightWidth=a.offsetWidth||0,o.threshold=t.getDataset().threshold},getDisabledType:t=>("string"==typeof t?JSON.parse(t):t)||!1,range:(t,e,s)=>Math.min(Math.max(t,e),s),moveDirection(t,e,s,o){var n=o.state,i=n.threshold;n.position;var a=n.isopen||"none",r=n.leftWidth,l=n.rightWidth;0!==n.deltaX?"none"===a&&l>0&&-t>i||"none"!==a&&l>0&&l+t<i?this.openState("right",e,s,o):"none"===a&&r>0&&t>i||"none"!==a&&r>0&&r-t<i?this.openState("left",e,s,o):this.openState("none",e,s,o):this.openState("none",e,s,o)},openState(t,e,s,o){let n=o.state,i=n.leftWidth,a=n.rightWidth,r="";switch(n.isopen=n.isopen?n.isopen:"none",t){case"left":r=i;break;case"right":r=-a;break;default:r=0}n.isopen!==t&&(n.throttle=!0,s.callMethod("change",{open:t})),n.isopen=t,e.requestAnimationFrame((()=>{e.addClass("ani"),this.move(r,e,s,o)}))},getDirection:(t,e)=>t>e&&t>10?"horizontal":e>t&&e>10?"vertical":"",resetTouchStatus(t,e){let s=e.state;s.direction="",s.deltaX=0,s.deltaY=0,s.offsetX=0,s.offsetY=0},stopTouchStart(t,e,s){let o=t.instance,n=s.state;this.resetTouchStatus(o,s);var i=t.touches[0];n.startX=i.clientX,n.startY=i.clientY},stopTouchMove(t,e){t.instance;let s=e.state,o=t.touches[0];s.deltaX=o.clientX-s.startX,s.deltaY=o.clientY-s.startY,s.offsetY=Math.abs(s.deltaY),s.offsetX=Math.abs(s.deltaX),s.direction=s.direction||this.getDirection(s.offsetX,s.offsetY)}},q={mounted(t,e,s){this.state={}},methods:{showWatch(t,e,s,o){P.showWatch(t,e,s,o,this)},touchstart(t,e){P.touchstart(t,e,this)},touchmove(t,e){P.touchmove(t,e,this)},touchend(t,e){P.touchend(t,e,this)}}},j=t=>{t.$renderjs||(t.$renderjs=[]),t.$renderjs.push("renderswipe"),t.mixins||(t.mixins=[]),t.mixins.push({beforeCreate(){this.renderswipe=this},mounted(){this.$ownerInstance=this.$gcd(this,!0)}}),t.mixins.push(q)},B={mixins:[k,{},{}],emits:["click","change"],props:{show:{type:String,default:"none"},disabled:{type:Boolean,default:!1},autoClose:{type:Boolean,default:!0},threshold:{type:Number,default:20},leftOptions:{type:Array,default:()=>[]},rightOptions:{type:Array,default:()=>[]}},unmounted(){this.__isUnmounted=!0,this.uninstall()},methods:{uninstall(){this.swipeaction&&this.swipeaction.children.forEach(((t,e)=>{t===this&&this.swipeaction.children.splice(e,1)}))},getSwipeAction(t="uniSwipeAction"){let e=this.$parent,s=e.$options.name;for(;s!==t;){if(e=e.$parent,!e)return!1;s=e.$options.name}return e}}};O(B),j(B);const E=t(B,[["render",function(t,g,m,w,b,v){const y=f,C=p;return e(),s(C,{class:"uni-swipe"},{default:o((()=>[n(C,{class:"uni-swipe_box","change:prop":t.wxsswipe.showWatch,prop:t.is_show,"data-threshold":m.threshold,"data-disabled":m.disabled,onTouchstart:t.wxsswipe.touchstart,onTouchmove:t.wxsswipe.touchmove,onTouchend:t.wxsswipe.touchend},{default:o((()=>[n(C,{class:"uni-swipe_button-group button-group--left"},{default:o((()=>[i(t.$slots,"left",{},(()=>[(e(!0),a(r,null,l(m.leftOptions,((i,a)=>(e(),s(C,{key:a,style:d({backgroundColor:i.style&&i.style.backgroundColor?i.style.backgroundColor:"#C7C6CD"}),class:"uni-swipe_button button-hock",onTouchstart:t.appTouchStart,onTouchend:e=>t.appTouchEnd(e,a,i,"left"),onClick:h((e=>t.onClickForPC(a,i,"left")),["stop"])},{default:o((()=>[n(y,{class:"uni-swipe_button-text",style:d({color:i.style&&i.style.color?i.style.color:"#FFFFFF",fontSize:i.style&&i.style.fontSize?i.style.fontSize:"16px"})},{default:o((()=>[c(u(i.text),1)])),_:2},1032,["style"])])),_:2},1032,["style","onTouchstart","onTouchend","onClick"])))),128))]),!0)])),_:3}),n(C,{class:"uni-swipe_text--center"},{default:o((()=>[i(t.$slots,"default",{},void 0,!0)])),_:3}),n(C,{class:"uni-swipe_button-group button-group--right"},{default:o((()=>[i(t.$slots,"right",{},(()=>[(e(!0),a(r,null,l(m.rightOptions,((i,a)=>(e(),s(C,{key:a,style:d({backgroundColor:i.style&&i.style.backgroundColor?i.style.backgroundColor:"#C7C6CD"}),class:"uni-swipe_button button-hock",onTouchstart:t.appTouchStart,onTouchend:e=>t.appTouchEnd(e,a,i,"right"),onClick:h((e=>t.onClickForPC(a,i,"right")),["stop"])},{default:o((()=>[n(y,{class:"uni-swipe_button-text",style:d({color:i.style&&i.style.color?i.style.color:"#FFFFFF",fontSize:i.style&&i.style.fontSize?i.style.fontSize:"16px"})},{default:o((()=>[c(u(i.text),1)])),_:2},1032,["style"])])),_:2},1032,["style","onTouchstart","onTouchend","onClick"])))),128))]),!0)])),_:3})])),_:3},8,["change:prop","prop","data-threshold","data-disabled","onTouchstart","onTouchmove","onTouchend"])])),_:3})}],["__scopeId","data-v-ae2d0852"]]);const N=t({name:"uniSwipeAction",data:()=>({}),created(){this.children=[]},methods:{resize(){},closeAll(){this.children.forEach((t=>{t.is_show="none"}))},closeOther(t){this.openItem&&this.openItem!==t&&(this.openItem.is_show="none"),this.openItem=t}}},[["render",function(t,n,a,r,l,d){const h=p;return e(),s(h,null,{default:o((()=>[i(t.$slots,"default")])),_:3})}]]);const L=t({data:()=>({listData:[],addrId:null,token:g("accessToken"),options2:[{text:"取消",style:{backgroundColor:"#007aff"}},{text:"删除",style:{backgroundColor:"#F56C6C"}}]}),methods:{swipeChange(t,e){this.addrId=e},bindClick(t){1!==this.listData.length?"删除"==t.content.text&&w("/userCenter/deleteUserAddress",{addrId:this.addrId,authorization:this.token}).then((t=>{const{code:e,flag:s}=t;2e3===e&&s?(m({title:"删除成功！",icon:"none"}),this.getAddressList()):m({title:"删除失败！",icon:"none"})})).catch((t=>console.log(t))):m({title:"须保留一个收货地址",icon:"none"})},addressAdd(){b({url:"/pages/addressedit/index"})},getAddressList(){this.token&&v("/userCenter/getUserAddressList",{authorization:this.token}).then((t=>{const{code:e,flag:s,data:o}=t;2e3===e&&s&&(this.listData=o)})).catch((t=>console.log(t)))},goAddressAdd(t){b({url:`/pages/addressedit/index?addrId=${t}`})}},onBackPress:t=>(y({url:"/pages/my/index"}),!0),onLoad(){this.token=g("accessToken"),this.getAddressList()}},[["render",function(t,i,d,h,g,m){const w=f,b=p,v=x(C("uni-swipe-action-item"),E),y=x(C("uni-swipe-action"),N),k=S;return e(),a(r,null,[(e(),s(b,{key:1,class:"addrss-list"},{default:o((()=>[(e(!0),a(r,null,l(g.listData,((t,i)=>(e(),s(b,{class:"list-box",key:t.addrId,onClick:e=>m.goAddressAdd(t.addrId)},{default:o((()=>[n(y,null,{default:o((()=>[n(v,{"right-options":g.options2,"auto-close":!1,onChange:e=>m.swipeChange(e,t.addrId),onClick:m.bindClick},{default:o((()=>[n(b,{class:"info"},{default:o((()=>[n(w,null,{default:o((()=>[c(u(t.addrName)+" "+u(t.addrPhone),1)])),_:2},1024),n(w,{class:"def"},{default:o((()=>[c(u(1===t.state?"默认":""),1)])),_:2},1024)])),_:2},1024),n(b,{class:"address"},{default:o((()=>[c(u(t.address),1)])),_:2},1024)])),_:2},1032,["right-options","onChange","onClick"])])),_:2},1024)])),_:2},1032,["onClick"])))),128))])),_:1})),n(b,{class:"btn-box"},{default:o((()=>[n(k,{type:"warn",onClick:m.addressAdd},{default:o((()=>[c("新增收货地址")])),_:1},8,["onClick"])])),_:1})],64)}],["__scopeId","data-v-2f8dab27"]]);export{L as default};
